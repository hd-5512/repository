Mysql最重要、最与众不同的特性是他的存储引擎架构

Mysql被设计成将 查询处理(Query Processing) 以及其他系统任务(Server Task) 和 数据存储/提取 相分离

逻辑架构分成三层

第一层 客户端 (最上层) 连接处理、授权认证、安全等等 和大多数的C/S类似

第二层 服务器:核心服务功能(查询解析、分析、优化、缓存  所有内置函数、存储过程、触发器、视图等)

所有跨 存储引擎的功能都在这一层  类似是一个 MVC中的controller 

第三层 存储引擎:负责Mysql中数据的存储和提取 

服务器(Mysql Server程序)通过API与存储引擎进行通信，这些API比如『开始一个事务』『根据主键提取一行记录』等

但是 存储引擎不会去解析SQL 不同存储引擎之间不会相互通信 只是简单地响应上层服务器的请求

(InnoDB例外 它会解析外键 因为Mysql服务器本身没有实现该功能)



连接管理和安全性

每个 客户端连接 都会在 服务器进程 中拥有一个 线程

这个 连接的查询 指挥在 这个单独的线程中执行  

而这个线程 只能在某个CPU核心或者CPU中运行

服务器会负责缓存线程 因此不需要为每个新建的连接创建或者销毁线程

(Mysql 5.5 或者更新的版本 提供了一个API 支持线程池Thread-Pooling插件 可以使用池中少量的线程来服务大量的连接 

这里可以发现 连接池中的连接数并非越大越好  因为他们都依赖CPU 更多的连接数也无法同时进行运行 而是通过系统内核的调用 时分复用上下文切换来逐个执行 

如此一样的队列 过多的连接数在轮流执行过程中会产生很多系统内部I/O的执行而带来不必要的性能消耗)

安全:
优先通过 用户名 主机信息 密码进行验证
连接成功后 再继续验证  对某个数据库是否有SELECT权限等






优化与执行

Mysql会解析查询并创建内部数据结构 (解析树) 然后对它进行各种优化

优化解释器 Explain 

用户可以通过特殊的关键字来 提示 优化器 影响它的决策过程


对于SELECT语句 在解析查询之前 服务器优先检查查询缓存(Query Cache)
如果在里面可以找到对应的查询 就必须再去执行查询解析、优化和执行的整个过程
可以直接返回查询缓存中的结果集



并发控制























 






